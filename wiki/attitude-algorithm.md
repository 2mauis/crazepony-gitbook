

#  姿态解算


> 作者：nieyong

姿态解算的英文是attitude algorithm，也叫做姿态分析，姿态估计，姿态融合。姿态解算是指把陀螺仪、加速度计、罗盘等的数据融合在一起，得出飞行器的空中姿态。

飞行器从陀螺仪的三轴角速度通过四元数法得到的俯仰、偏航和滚转角，这是**快速解算**，结合三轴地磁和三轴加速度得到**漂移补偿**和**深度解算**。

## 数学模型
姿态是用来描述一个刚体的固连坐标系和参考坐标系之间的角位置关系，有一些数学表示方法。很常见的就是欧拉角，四元数，矩阵，轴角。

姿态解算需要解决的是四轴飞行器和地球的相对姿态问题。地球的坐标系又叫做**地理坐标系**，是固定不变的。正北，正东，正向上构成了这个坐标系的X，Y，Z轴，我们用坐标系R表示。四轴飞行器上固定着一个坐标系，用坐标系r表示。那么我们就可以用欧拉角，四元数等来描述r和R的角位置关系。这就是四轴飞行器姿态解算的数学模型和基础。

![](/assets/img/earth-coodinate.png)

## 角位置关系测量
如上所说，地球坐标系R是固定的。四轴飞行器上固定一个坐标系r，这个坐标系r在坐标系R中运动。那么如何知道坐标系r和坐标系R的角位置关系呢，也就是怎么知道飞行器相对于地球这个固定坐标系R转动了一下航向，或者侧翻了一下机身，或者掉头下栽。这就是传感器需要测量的数据，传感器包括陀螺仪，加速度计，磁力计。通过获得这些测量数据，得到坐标系r和坐标系R的角位置关系，这就是姿态解算。
